548

Chapter 22

tmpfile

tmpnam

Input/Output

Note that we can use redirection 10 discard the output of canopen and simply test
the status value it returns.

Temporary Files

FILE #*tmpfile (void) ;
char *tmpnam(char *s) ;

Real-world programs often need to create temporary files—files that exist only as
long as the program 1s running. C compilers. for instance, often create temporary
files. À compiler might first translate a C program to some intermediate form,
which Il stores in a file. The compiler would then read the file later as it translates
the program lo object code. Once the program 1s completely compiled, there's no
need to preserve the file containing the program’s intermediate form. <stdio.h>
provides two functions. tmpfile and tmpnam, for working with temporary files.

tmpfile creates a temporary file (opened in "wb+" mode) that will exist
unül 1s closed or the program ends. À call of tmp£ile returns a file pointer that
can be used to access the file later:

FILE *tempptr;

tempptr tmpfile () ; /* creates a temporary file */

[f it fails to create a file. tmp£ile returns a null pointer.

Although tmpfile 1s easy to use, it has a couple of drawbacks: (1) we don’t
know the name of the file that tmpfile creates, and (2) we can’t decide later to
make the file permanent. If these restrictions turn out to be a problem. the alterna-
tive 1S to create a temporary file using £open. Of course, we don’t want this file to
have the same name as a previously existing File, so we need some way to generate
new file names; that's where the tmpnam function comes in.

tmpnam generates a name for a temporary file. If its argument is a null

pointer, tmpnam stores the file name 1n a static variable and returns à pointer to it:
char *filename ;
£ilename = tmpnam (NULL) ; /* creates a temporary file name */

Otherwise, tmpnam copies the file name into a character array provided by the
programmer:

char filename [L _ tmpnam] ;
tmpnam (filename) ; /* creates a temporary file name */

In the latter case. Empnam also returns a pointer to the first character of this array.
L _ tmpnamis a macro in <stdio.h> that specifies how long to make a character
array that will hold à temporary file name.
