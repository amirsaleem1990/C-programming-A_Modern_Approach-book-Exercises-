isprint function >23.5

XOI.C

 

20.1  Bitwise Operators 515

msg contains the following lines:

Trust not him with your secrets, who, when left
alone in your room, turns over your papers.
--Johann Kaspar Lavater (1741-1801)

To encrypt the msg file. saving the encrypted message in newmsg. we*d use the
following command:

XOr <msg >newmsqg
newmsg will now contain thesc lines:

YTSUR HIR NOK QORN _IST UCETCRU, ONI, QNCH JC@R
GJIHC OH _IST TIIK, RSTHU IPCT _IST VGVCTU.
--1INGHH mGUVGT jGPGRCT (1741-1801)

To recover the original message, we’d use the command
xor <newmsg

which will display it on the screen.

Às the example shows, our program won" change some characters, includine
digits. XORing these characters with & would produce invisible control characters,
which could cause problems with some operating systems. In Chapter 22, we*1Il see
how Lo avoid problems when reading and writing files that contain control charac-
ters. Until then, we*II play it safe by using the isprint function to make sure
that both the original character and the new (encrypted) character are printing char-
acters (i.e.… not control characters). If either character fails this test, we’Il have the
program write the original character instead of the new character.

Here’s the finished program, which is remarkably short:

/* Performs XOR encryption */

finclude <ctype.h>
#include <stdio.h>

#define KEY 'g!'

int main (void)

(

int orig char, new char;

while ((orig _ char = getchar()) != EoOF) Ç{
new_char = orig char ” KEy;
if (isprint (orig char) && isprint (new char))
putchar (new _ char) ;
else
putchar (orig _char) ;
}

return 0;
