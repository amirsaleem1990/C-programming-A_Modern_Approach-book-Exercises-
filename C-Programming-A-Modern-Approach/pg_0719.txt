694

Chapter 26 Miscellaneous Library Functions

difftime

mktime

time (&cur time) ;

where cur_time is à variable of type time t.

The difftime function returns the difference between t imeo (the earlier
time) and timel, measured in seconds. Thus, to compute the actual running time
of a program (not the processor time). we could use the following code:

#Hinclude <stdio.h>
#include <time.h>

int main(void)

{

time_t start _ time = time (NULL) ;

print£ ("Running time: %g sec.\n",
difftime (time (NULL), start_time));
return 0;

}

The mktime function converts a broken-down time (stored in the structure
that its argument points to) into a calendar time, which it then returns. As a side
effect, mktime adjusts the members of the structure according to the following
rules:

= mktime changes any members whose values aren’t within their legal ranges
(see Table 26.1). Those alterations may in turn require changes to other mem-
bers. If tm_sec is too large, for example, mktime reduces it to the proper
range (0-59), adding the extra minutes to tm_min. If tm_min is now too
large, mkt ime reduces it and adds the extra hours to tm_hour. If necessary,
the process will continue to the tm_mday, tm_mon. and tm_year mem-
bers.

u After adjusting the other members of the structure (if necessary), mktime
sets tm_wday (day of the week) and tm_yday (day of the year) to their cor-
rect values. There’s never any need to initialize the values of tm_wday and
tm_yday before calling mktime; it ignores the original values of these
members.

mktime's ability to adjust the members of a tm structure makes it useful for
time-related arithmetic. As a example, let’s use mktime to answer the following
question: If the 2012 Olympics begin on July 27 and end 16 days later. what is the
ending date? We'Il start by storing July 27, 2012 in a tm structure:

struct tm t;

t.tm mday = 27;
t.tm mon = 6; /* July */
t.tm year = 112; /* 2012 */

We'Il also initialize the other members of the structure (except tm_wday and
tm_yday) to ensure that they don’t contain undefined values that could affect the
answer:
