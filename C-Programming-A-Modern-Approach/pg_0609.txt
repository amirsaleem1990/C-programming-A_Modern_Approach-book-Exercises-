584 Chapter 22

Section 22.5

Section 22.7

Section 22.8

13.

© 14.

@ 15.

16.

@

Input/Ouiput
if ((Fp = fopen(filename, "r")) != NULL) {
while (fgetc(fp) != EOF)
if (£getc(fp) == '.!)
I1++ ;

Éclose (fp) ;

}

return n;

}

Write the following function:
int line length(const char *filename, int n});

The function should return the length of line n in the text file whose name is filename
(assuming that the first line in the file is line 1). If the line doesn't exist, the function should
return 0.

(a) Write your own version of the £gets function. Make it behave as much like the real
Égets function as possible; in particular, make sure that it has the proper return value. To
avoid conflicts with the standard library, don’t name your function fgets.

(b) Write your own version of fputs, following the same rules as in part (a).

Write calls of £seek that perform the following file-positioning operations on a binary file
whose data is arranged in 64-byte “records.” Use £p as the file pointer in each case.

(a) Move to the beginning of record n. (Assume that the first record in the file is record 0.)
(b) Move to the beginning of the last record in the file.

(c) Move forward one record.
(d) Move backward two records.

Assume that str is a string that contains a ‘‘sales rank’” immediately preceded by the #
symbol (other characters may precede the # and/or follow the sales rank). À sales rank is a
series of decimal digits possibly containing commas, such as the following examples:

989
24,675
1,162,620

Write a call of sscan£ that extracts the sales rank (but not the # symbol) and stores it in a
string variable named sales_rank.

Programming Projects

Extend the canopen ..c program of Section 22.2 so that the user may put any number of
file names on the command line:

canopen foo bar baz

The program should print a separate can be opened or can' t be opened message for
each file. Have the program terminate with status EXIT FAILURE if onc or more of the
files can’t be opened.

Write à program that converts all letters in a file to upper case. (Characters other than letters
shouldn’t be changed.) The program should obtain the file name from the command line and
Write its output to stdout.
