526 Chapter 20  Low-Level Programming

Section 20.2

® s.

0.

10.

ll.

*13,

@ 14.

rotate_left (0x12345678, 4) should return 0x23456781 if integers are 32 bits
long.) rotate_right is similar. but it should “rotate” bits to the right instead of the left.

Let £ be the following function:

unsigned int f (unsigned int i, int m, int n)

{

return (i >> (m + 1 - n)) & -(-0 << n);
}

(a) What is the value of =- (-0 << n)?
(b) What does this function do?

(a) Write the following function:
int count ones (unsigned char ch);
count_ones should return the number of ! bits in ch.

(b) Write the function in part (a) without using a loop.

Write the following function:
unsigned int reverse _ bits (unsigned int n);

reverse bits should return an unsigned integer whose bits are the same as those in n
but in reverse order.

Each of the following macros defines the position of a single bit within an integer:

#define SHIFT BIT 1
#define CTRL BIT 2
#define ALT BIT 4

The following statement ts supposed to test whether any of the three bits have been set. but it
never displays the specified message. Explain why the statement doesn't work and show
how to fix it. Assume that key_code is an int variable.

if (key code & (SHIFT BIT | CTRL BIT | ALT BIT) == O)
print£f("No modifier keys pressed\n") ;

The following function supposedly combines two bytes to form an unsigned short integer.
Explain why the function doesn’t work and show how to fix it.

unsigned short create short (unsigned char high byte,
unsigned char low byte)
{

return high _ byte << 8 + low byte;

}

If n is an unsigned int variable, what effect does the following statement have on the
bits in n?

n & n -Tl;

Hint: Consider the effect on n if this statement is executed more than once.

When stored according to the IEEE floating-point standard. a float value consists of a |-
bit sign (the leftmost—or most significant—bit), an 8-bit exponent, and à 23-bit fraction. in
that order. Design à structure type that occupies 32 bits, with bit-field members correspond-
ing to the sign. exponent, and fraction. Declare the bit-fields to have type unsigned int.
Check the manual for your compiler to determine the order of the bit-fields.
