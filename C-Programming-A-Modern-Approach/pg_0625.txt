600 Chapter 23  Library Support for Numbers and Character Data

Table 23.8
Relationship between
FLT EVAL METHOD
and the £loat t and
double t Types

 

 

 

 

 

 

 

Value of VTeaning of Meaning of
FLT EVAL METHOD float t double t
0 £loat double
1 double double
2 long double long double
Other Implementation-defined _ Implementation-defined

 

Macros

C99 adds a number of macros to <math.h>. l’Il mention just two of them at this
point. INFINITY represents the float version of positive or unsigned infinity.
(IF the implementation doesn’t support infinity, then INFINITY represents a
float value that overflows at compile time.) The NAN macro represents the
£loat version of “not a number” More specifically, it represents a “quiet” NaN
(one that doesn't raise an exception if used in an arithmetic expression). If quiet
NaNs aren’t supported, the NAN macro won°t be defined.

l'Il cover the function-like macros in <math.h> later in the section. along
with ordinary functions. Macros that are relevant only to a specific function will be
described with the function itself.

Errors
For the most part, the C99 version of <math.h> deals with errors in the same
way as the C89 version. However, there arc a few twists that we’!l need to discuss.

First, C99 provides several macros that give implementations a choice of how
errors are signaled: via a value stored in errno, via a floating-point exception, or
both. The macros MATH_ERRNO and MATH ERREXCEPT represent the integer
constants | and 2, respectively. À third macro, math errhandling, represents
an int expression whose value is either MATH ERRNO, MATH ERREXCEPT, or
the bitwise OR of the two values. (Tt’s also possible that math errhandling
isn’t really a macro; it might be an identifier with external linkage.) The value of
math_errhandling can’t be changed within a program.

Now, let’s see what happens when a domain error occurs during a call of one
of the functions in <math.h>. The C89 standard says that EDOM is stored in
errno. The C99 standard, on the other hand, states that if the expression
math_errhandling & MATH _ERRNO is nonzero (i.e., the MATH ERRNO bit is
set), then EDOM is stored in errno. If the expression math_errhandling &
MATH_ERREXCEPT 1s nonzero, the invalid foating-point exception is raised.
Thus, either or both actions are possible, depending on the value of
math_errhandlinoa.

Finally. let’s turn to the actions that take place when a range error is detected
during a function call. There are two cases, based on the magnitude of the func-
tion’s return value.

Overflow. 1f the magnitude is too large, the C89 standard requires the function
lo return posilive or negative HUGE VAL, depending on the sign of the correct
